{% extends "layout.html" %} 
{% from "_macros.html" import render_field, render_button %} 

{% block title %}Blood request{% endblock %} 

{% block content %}

{% if current_user.is_physician() %}
<a href="{{ url_for('create_blood_request') }}">Create new</a>
{% endif %}

<form method="POST">
    <h4>Search blood request</h4>
    {{ render_field(form.name) }}
    {{ render_field(form.abo_rh) }}
    {{ render_button('Search') }}
</form>

<table>
  <thead>
    <tr>
      <th>First name</th>
      <th>Last name</th>
      <th>ABO/Rh</th>
      <th>Units</th>
      <th>Doctor's name</th>
      <th>Request date</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for request in requests %}
    <tr>
      <td>{{ request.patient_first_name }}</td>
      <td>{{ request.patient_last_name }}</td>
      <td>{{ request.abo_rh }}</td>
      <td>{{ request.units }}</td>
      <td>{{ request.user.first_name + ' ' + request.user.last_name }}</td>      
      <td>{{ request.request_date.strftime('%Y-%m-%d') }}</td>
      <td>{{ request.status }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
